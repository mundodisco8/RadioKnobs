Version 4
SHEET 1 2456 1012
WIRE -208 -96 -288 -96
WIRE -32 -96 -208 -96
WIRE 160 -96 -32 -96
WIRE 288 -96 160 -96
WIRE 464 -96 288 -96
WIRE 624 -96 624 -112
WIRE 624 -96 464 -96
WIRE 688 -96 624 -96
WIRE 816 -96 784 -96
WIRE 848 -96 848 -112
WIRE 848 -96 816 -96
WIRE 880 -96 848 -96
WIRE 1408 -96 880 -96
WIRE 1456 -96 1408 -96
WIRE -288 -48 -288 -96
WIRE 816 -48 816 -96
WIRE 1456 -48 1456 -96
WIRE 288 -32 288 -96
WIRE 704 -16 704 -48
WIRE 704 -16 672 -16
WIRE -32 32 -32 -96
WIRE 160 32 160 -96
WIRE 704 32 704 -16
WIRE 704 32 624 32
WIRE 816 32 816 16
WIRE 816 32 704 32
WIRE 464 48 464 -96
WIRE 880 80 880 -96
WIRE 912 80 880 80
WIRE 1216 80 1200 80
WIRE 1264 80 1216 80
WIRE 1456 80 1456 32
WIRE -288 96 -288 32
WIRE 288 96 288 48
WIRE 624 96 624 32
WIRE 704 96 704 32
WIRE 880 176 880 80
WIRE 912 176 880 176
WIRE 1216 176 1216 80
WIRE 1216 176 1200 176
WIRE -128 224 -128 208
WIRE -128 224 -160 224
WIRE -32 224 -32 112
WIRE -32 224 -128 224
WIRE 32 224 -32 224
WIRE 160 224 160 112
WIRE 160 224 96 224
WIRE 288 224 288 160
WIRE 288 224 160 224
WIRE 464 224 464 112
WIRE 464 224 288 224
WIRE 624 224 624 160
WIRE 624 224 464 224
WIRE 704 224 704 176
WIRE 704 224 624 224
WIRE 736 224 704 224
WIRE -224 272 -320 272
WIRE -160 272 -160 224
WIRE 1056 272 1056 240
WIRE -320 288 -320 272
WIRE -224 288 -224 272
WIRE -208 288 -224 288
WIRE 1264 304 1264 80
WIRE 1264 304 1120 304
WIRE -208 336 -224 336
WIRE 1120 336 1120 304
WIRE 1120 336 1040 336
WIRE 1216 336 1120 336
WIRE -320 416 -320 368
WIRE -224 416 -224 336
WIRE -224 416 -320 416
WIRE -160 416 -160 352
WIRE -160 416 -224 416
WIRE 1216 432 1216 336
WIRE -320 448 -320 416
WIRE 1040 448 1040 336
WIRE -32 464 -32 224
WIRE 704 560 704 224
WIRE 848 640 848 608
WIRE 848 640 752 640
WIRE 1040 640 1040 512
WIRE 1040 640 848 640
WIRE 1104 640 1040 640
WIRE 1216 640 1216 512
WIRE 1216 640 1184 640
WIRE 1264 640 1216 640
WIRE 1392 640 1344 640
WIRE 704 848 704 656
WIRE -32 912 -32 528
WIRE 1216 912 1216 640
WIRE 1216 912 -32 912
FLAG 704 848 0
FLAG -288 96 0
FLAG -320 448 0
FLAG 624 -112 Vs
FLAG 672 -16 Vgpmos
FLAG 1456 80 0
FLAG 1056 272 0
FLAG 848 -112 Vd
FLAG -208 -96 Vin
FLAG 1408 -96 Vout
FLAG 848 608 Vgnmos
FLAG -128 208 PWR_SWITCH
FLAG 736 224 Va
SYMBOL res -48 16 R0
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 144 16 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res 688 80 R0
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res 1200 624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 300k
SYMBOL res 1200 416 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL cap 448 48 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL cap 96 208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL cap 1024 448 R0
SYMATTR InstName C4
SYMATTR Value 22µ
SYMBOL pmos 784 -48 M270
SYMATTR InstName M2
SYMATTR Value IRF7309P
SYMBOL nmos 752 560 M0
SYMATTR InstName M1
SYMATTR Value IRF7309N
SYMBOL diode 640 160 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value BAV99HY
SYMBOL diode -16 528 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value BAV99HY
SYMBOL zener 272 160 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value BZX84C15L
SYMBOL res 1360 624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL voltage -288 -64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage -320 272 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -526 231 Left 2
SYMATTR Value PWL(0 0 4.99 0 5 5 5.1 5 5.11 0 6.99 0 7 5 7.2 5 7.21 0 9.99 0 10 5 19.99 5 20 0)
SYMATTR InstName V2
SYMBOL sw -160 368 M180
SYMATTR InstName S1
SYMATTR Value MYSW
SYMBOL res 272 -48 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res 1440 -64 R0
SYMATTR InstName R9
SYMATTR Value 4
SYMATTR SpiceLine pwr=40W
SYMBOL cap 800 -48 R0
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL PowerProducts\\LT3007-3.3 1056 128 R0
WINDOW 3 26 -129 Left 2
SYMATTR InstName U1
TEXT -848 536 Left 2 !.model MYSW SW(Ron=1 Roff=1Meg Vt=.5 Vh=-.4)
TEXT -848 568 Left 2 !.tran 0 20 0 .001
TEXT 128 -240 Left 2 ;Zener needs a resistor to current limit. \nFigure out max voltage, see bias point \nin zener datasheet, and dimension accordingly
TEXT 1528 0 Left 2 ;Resistor models a load of 40W
TEXT 1360 712 Left 2 ;This was meant to be the GPIO signal, but it's 20V!!!!\nNeed to add the voltage regulator.\nThe drawback is that we are biasing the NMOS with 3V3 now, so when powering off, the time\nit gets to discharge C3 below Vth is way sorter, so we need bigger C3/C5\nAlso, the signal value when low is .4V because of the drop in D3
TEXT -344 -80 Right 2 ;Input\npower
TEXT -1392 240 Left 2 ;Switch Simulation\nFrom 0 to t=5, remains open\nOn t=5, close for half a second, power in output, it should latch\nRemain open until t=10\nOn t=10, close and leave closed. After some time (depending on R5/C3), Vout should go to 0.
TEXT 1376 608 Left 2 ;Signal to Raspberry Pi GPIO
TEXT 800 -160 Left 2 ;Is(M2)*(V(Vs)-V(Vd))
TEXT 800 -312 Left 2 ;Thermal analysis. Worst case is switching off when load is max (plot Is(M2)*(V(Vs)-V(Vd)))\nPower peaks at ~10W for <15ms -> .15J generated\nAt 90°C/W (datasheet) -> 13.5°C temp raise. A little hot, but given that it's a worst case scenario, \nand not repeable I think it's acceptable
